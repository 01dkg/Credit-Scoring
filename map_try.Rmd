---
title: "Kpmg_Proj"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
## Load the library
library(dplyr)
library(maps)
library(reshape2)
library(leaflet)
library(ggplot2)
library(ggmap)
library(gridExtra)

library(readr)
Data <- read_delim("E:/KPMG/Data/Data.csv", 
    ";", escape_double = FALSE, trim_ws = TRUE)
View(Data)
us_weather_df <- data.frame(Data)
weatherIcon <- makeIcon(
                         iconUrl = "./fig/weather.png",
                         iconWidth = 30, 
                         iconHeight = 30
                        )

popupInfo <- paste(us_weather_df[['ContractRef']], 
                   ", ", 
                   us_weather_df[['LoanBalance']],
                   "<br>", 
                   "Average January Temp in F:  ",
                   us_weather_df[['DefaultedLoans']],
                   "<br>", 
                   "Credit Rating:  ",
                   us_weather_df[['CreditRating']],
                   "<br>", 
                   "LTV:  ",
                   us_weather_df[['LTV']],
                   "<br>", 
                   "Property Value:  ",
                   us_weather_df[['PropertyValue']],
                   sep='')


us_mainland_temp <- leaflet(us_weather_df) %>% 
                          setView(-93.65, 42.0285, zoom = 4) %>%
                                 addTiles() %>%
                                      addMarkers(Data$AddressLongitude, Data$AddressLatitude, popup= ~ popupInfo,
                                      options = popupOptions(closeButton = TRUE),
                                      clusterOptions = markerClusterOptions(), 
                                      icon = weatherIcon)


us_mainland_temp

```
